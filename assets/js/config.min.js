$(document).ready(function() {
    const updateList = function() {
             $.getJSON('/.json',function(data) {
                  let html = '';
                  for(let i=0;i<data.length;i++) {
                      html+='<li><a href="/'+data[i]+'/">'+data[i]+'</a></li>';
                  } 
                 $('#lgl').html(html);
             });
    }
    updateList();
    setInterval(updateList,10000);
    $('#btnDemo').click(function() {
        $('#fldcurl').val('https://raw.githubusercontent.com/energychain/casa-corrently-webinterface/master/sample_config.json');
    });
    $('#configFrm').ajaxForm(function(dl) { 
        $('#sbtn').attr('disabled','disabled');
        console.log(dl);
        if(dl.err==null) {
            setTimeout(function() {
                $.getJSON('/.json',function(data) {
                    location.href='/'+data[0]+'/';
                });
            },10000);
        }
    });  
        $.getJSON('/reading/meterIds',function(data) {
            $('#btnDataEdge').show();
        })fail(function() {
            $('#btnDataEdge').hide();
        });
});