window.modActive=!1,$(document).ready((function(){let t=!0,s="last24h",a=9999,e=9999,i=-1,o="./msg",n=0;void 0!==$.getUrlVar("reset")&&window.localStorage.removeItem("msg"),void 0!==$.getUrlVar("s")?(s=$.getUrlVar("s"),"last24h"==s&&$("#selectorLabel").html("Die letzten 24 Stunden"),"last7d"==s&&$("#selectorLabel").html("Die letzten 7 Tage"),"last30d"==s&&$("#selectorLabel").html("Die letzten 30 Tage"),"last90d"==s&&$("#selectorLabel").html("Die letzten 90 Tage"),"last180d"==s&&$("#selectorLabel").html("Die letzten 180 Tage"),"last365d"==s&&$("#selectorLabel").html("Die letzten 365 Tage"),"next24h"==s&&$("#selectorLabel").html("Kommende 24 Stunden")):$("#selectorLabel").html("Die letzten 24 Stunden");const l=function(){try{if(void 0!==window.localStorage.getItem("msg")&&null!==window.localStorage.getItem("msg")){let o=JSON.parse(window.localStorage.getItem("msg"));a!==o.stats[s].energyPrice_kwh&&(9999!==a&&(a<o.stats[s].energyPrice_kwh&&($("#priceUp").show(),$("#priceDown").hide(),$("#energyPrice_kwh").addClass("corrently_orange"),$("#energyPrice_kwh").removeClass("corrently_green")),a>o.stats[s].energyPrice_kwh&&($("#priceUp").hide(),$("#priceDown").show(),$("#energyPrice_kwh").removeClass("corrently_orange"),$("#energyPrice_kwh").addClass("corrently_green"))),a=o.stats[s].energyPrice_kwh),e!==o.stats[s].incomeSaldo&&(9999!==e&&(e<o.stats[s].incomeSaldo&&($("#costDown").show(),$("#costUp").hide(),$("#incomeSaldo").addClass("corrently_green"),$("#incomeSaldo").removeClass("corrently_orange")),e>o.stats[s].incomeSaldo&&($("#costDown").hide(),$("#costUp").show(),$("#incomeSaldo").addClass("corrently_orange"),$("#incomeSaldo").removeClass("corrently_green"))),e=o.stats[s].incomeSaldo),0==o.stats[s].energyProd_wh&&(o.stats[s].energyProd_wh=1e-4),"last24h"==s&&($("#modErz").attr("max","100"),$("#modBedarf").attr("max","100")),"last7d"==s&&($("#modErz").attr("max","1000"),$("#modBedarf").attr("max","1000")),"last30d"==s&&($("#modErz").attr("max","5000"),$("#modBedarf").attr("max","5000")),"last90d"==s&&($("#modErz").attr("max","5000"),$("#modBedarf").attr("max","5000")),"last180d"==s&&($("#modErz").attr("max","25000"),$("#modBedarf").attr("max","25000")),"last365d"==s&&($("#modErz").attr("max","50000"),$("#modBedarf").attr("max","50000")),$("#eigenRow").show();let n=1-o.stats[s].energyOut_wh/o.stats[s].energyProd_wh;if(!1===window.modActive)$("#modEigenverbrauch").val(100*n),$("#modAmotisation").val(o.stats[s].amortization),$("#amotisation").html(o.stats[s].amortization),$("#erz").html((o.stats[s].energyProd_wh/1e3).toLocaleString("de-DE",{minimumFractionDigits:3,maximumFractionDigits:3})),$("#modErz").val(o.stats[s].energyProd_wh/1e3),$("#modBedarf").val(o.stats[s].consumption_wh/1e3);else{o.stats[s].amortization=1*$("#modAmotisation").val(),o.stats[s].energyProd_wh=1e3*$("#modErz").val(),o.stats[s].consumption_wh=1e3*$("#modBedarf").val(),n=$("#modEigenverbrauch").val()/100;let t=o.stats[s].energyIncome/o.stats[s].energyOut_wh;o.stats[s].energyOut_wh=o.stats[s].energyProd_wh*(1-n),o.stats[s].energySelf_wh=o.stats[s].energyProd_wh-o.stats[s].energyOut_wh,o.stats[s].energyIncome=o.stats[s].energyOut_wh*t,o.stats[s].energySavingsSelf=o.meterinfo.energyPriceWh/100*o.stats[s].energySelf_wh,o.stats[s].energySavingsSelf=Math.round((o.meterinfo.energyPriceWh-t)*o.stats[s].energySelf_wh*100)/100,o.stats[s].energyRevenue=o.stats[s].energyIncome+o.stats[s].energySavingsSelf+o.stats[s].correntlyIncome,o.stats[s].energy_wh=o.stats[s].consumption_wh-o.stats[s].energySelf_wh,o.stats[s].energyCost=o.stats[s].energy_wh*o.meterinfo.energyPriceWh,o.stats[s].energySpendings=o.stats[s].energyCost+o.stats[s].baseCosts+o.stats[s].amortization,o.stats[s].incomeSaldo=o.stats[s].energyRevenue-o.stats[s].energySpendings,o.stats[s].energyPrice_kwh=o.stats[s].incomeSaldo/o.stats[s].consumption_wh*-1e3,o.stats[s].energyPriceWh=o.stats[s].energyPrice_kwh/1e3}if($("#eigenverbrauchsQuote").html(Math.round(100*n)),$("#amotisation").html(o.stats[s].amortization),$("#bedarf").html((o.stats[s].consumption_wh/1e3).toLocaleString("de-DE",{minimumFractionDigits:3,maximumFractionDigits:3})),$("#energyPrice_kwh").html((100*o.stats[s].energyPrice_kwh).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),$("#last24h").html((100*o.stats.last24h.energyPrice_kwh).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),void 0!==o.stats.last7d&&$("#last7d").html((100*o.stats.last7d.energyPrice_kwh).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),void 0!==o.stats.last30d&&$("#last30d").html((100*o.stats.last30d.energyPrice_kwh).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),void 0!==o.stats.last90d&&$("#last90d").html((100*o.stats.last90d.energyPrice_kwh).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),void 0!==o.stats.last180d&&$("#last180d").html((100*o.stats.last180d.energyPrice_kwh).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),void 0!==o.stats.next24h&&$("#next24h").html((100*o.stats.next24h.energyPrice_kwh).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),void 0!==o.stats.last365d&&$("#last365d").html((100*o.stats.last365d.energyPrice_kwh).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),$(".updateTS").html(new Date(o.time).toLocaleString()),$("#e24h").html(o.stats.last24h.energyRevenue.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),void 0!==o.stats.last7d&&$("#e7d").html(o.stats.last7d.energyRevenue.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),void 0!==o.stats.last30d&&$("#e30d").html(o.stats.last30d.energyRevenue.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),void 0!==o.stats.last90d&&$("#e90d").html(o.stats.last90d.energyRevenue.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),void 0!==o.stats.last180d&&$("#e180d").html(o.stats.last180d.energyRevenue.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),void 0!==o.stats.last365d&&$("#e365d").html(o.stats.last365d.energyRevenue.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),$("#a24h").html(o.stats.last24h.energySpendings.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),void 0!==o.stats.last7d&&$("#a7d").html(o.stats.last7d.energySpendings.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),void 0!==o.stats.last30d&&$("#a30d").html(o.stats.last30d.energySpendings.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),void 0!==o.stats.last90d&&$("#a90d").html(o.stats.last90d.energySpendings.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),void 0!==o.stats.last180d&&$("#a180d").html(o.stats.last180d.energySpendings.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),void 0!==o.stats.last365d&&$("#a365d").html(o.stats.last365d.energySpendings.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),$("#incomeSaldo").html((-1*o.stats[s].incomeSaldo).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),$("#s24h").html((-1*o.stats.last24h.incomeSaldo).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),void 0!==o.stats.last7d?$("#s7d").html((-1*o.stats.last7d.incomeSaldo).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})):$(".row7d").hide(),void 0!==o.stats.last30d?$("#s30d").html((-1*o.stats.last30d.incomeSaldo).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})):$(".row30d").hide(),void 0!==o.stats.last90d?$("#s90d").html((-1*o.stats.last90d.incomeSaldo).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})):$(".row90d").hide(),void 0!==o.stats.last180d?$("#s180d").html((-1*o.stats.last180d.incomeSaldo).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})):$(".row180d").hide(),void 0!==o.stats.last365d?$("#s365d").html((-1*o.stats.last365d.incomeSaldo).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})):$(".row365d").hide(),void 0!==o.stats.next24h||$(".rownext24h").hide(),document.title=(100*o.stats[s].energyPrice_kwh).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})+"/kWh "+(-1*o.stats[s].incomeSaldo).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})+"/Tag",void 0!==o.stats[s].saldo_wh){let t=0,a=0,e=0,i=0;for(let n=0;n<o.stats[s].saldo_wh.saldo.length;n++)o.stats[s].saldo_wh.saldo[n]>0?(t+=o.stats[s].saldo_wh.saldo[n],a++):(e+=o.stats[s].saldo_wh.saldo[n],i++);let n=0,l=0;a>0&&(n=t/a),i>0&&(l=e/i);let r='<table width="90%" style="width:90%"><tr style="height:5px;">',d=new Date(o.stats[s].saldo_wh.start).getDay();for(let t=0;t<o.stats[s].saldo_wh.saldo.length;t++){let a=(o.stats[s].saldo_wh.end-o.stats[s].saldo_wh.start)/o.stats[s].saldo_wh.saldo.length*t+o.stats[s].saldo_wh.start,e=new Date(a).toLocaleString();new Date(a).getDay()===d||"last7d"!=s&&"last30d"!=s&&"last90d"!=s&&"last180d"!=s||(d=new Date(a).getDay(),r+='</tr><tr style="height:5px;">'),o.stats[s].saldo_wh.saldo[t]>0?o.stats[s].saldo_wh.saldo[t]>n?r+='<td style="background-color:#FFA700" title="'+e+" Bezug:"+Math.abs(o.stats[s].saldo_wh.saldo[t])+' Wh"></td>':r+='<td style="background-color:#FFF6E4" title="'+e+" Bezug:"+Math.abs(o.stats[s].saldo_wh.saldo[t])+' Wh"></td>':o.stats[s].saldo_wh.saldo[t]<l?r+='<td style="background-color:#006c32" title="'+e+" Einspeisung:"+Math.abs(o.stats[s].saldo_wh.saldo[t])+' Wh"></td>':r+='<td style="background-color:#86df9b" title="'+e+" Einspeisung:"+Math.abs(o.stats[s].saldo_wh.saldo[t])+' Wh"></td>'}r+="</tr></table>",$("#trail").html(r),void 0!==o.latest.power_w&&($("#peerStatus").show(),o.latest.power_w>0?o.latest.power_w>n?$("#peerStatus").css("color","#ffa700"):$("#peerStatus").css("color","#FFDD98"):o.latest.power_w<l?$("#peerStatus").css("color","#006c32"):$("#peerStatus").css("color","#86df9b"),$("#peerStatus").attr("title",o.latest.power_w+"W"))}let l=$("#einnahmenChart"),r=[],d=[],m=[],g=[];g.push("24 Stunden");let c=(o.stats.last24h.energySavingsSelf+o.stats.last24h.energyIncome+o.stats.last24h.correntlyIncome)/100;if(m.push({label:"Eigenstrom",backgroundColor:"#006c32",data:[o.stats.last24h.energySavingsSelf/c]}),m.push({label:"Einspeisung",backgroundColor:"#318b4e",data:[o.stats.last24h.energyIncome/c]}),m.push({label:"Corrently",backgroundColor:"#86df9b",data:[o.stats.last24h.correntlyIncome/c]}),void 0!==o.stats.last7d&&(c=(o.stats.last7d.energySavingsSelf+o.stats.last7d.energyIncome+o.stats.last7d.correntlyIncome)/100,g.push("7 Tage"),m[0].data.push(o.stats.last7d.energySavingsSelf/c),m[1].data.push(o.stats.last7d.energyIncome/c),m[2].data.push(o.stats.last7d.correntlyIncome/c)),void 0!==o.stats.last30d&&(g.push("30 Tage"),c=(o.stats.last30d.energySavingsSelf+o.stats.last30d.energyIncome+o.stats.last30d.correntlyIncome)/100,m[0].data.push(o.stats.last30d.energySavingsSelf/c),m[1].data.push(o.stats.last30d.energyIncome/c),m[2].data.push(o.stats.last30d.correntlyIncome/c)),void 0!==o.stats.last90d&&(g.push("90 Tage"),c=(o.stats.last90d.energySavingsSelf+o.stats.last90d.energyIncome+o.stats.last90d.correntlyIncome)/100,m[0].data.push(o.stats.last90d.energySavingsSelf/c),m[1].data.push(o.stats.last90d.energyIncome/c),m[2].data.push(o.stats.last90d.correntlyIncome/c)),void 0!==o.stats.last180d&&(g.push("180 Tage"),c=(o.stats.last180d.energySavingsSelf+o.stats.last180d.energyIncome+o.stats.last180d.correntlyIncome)/100,m[0].data.push(o.stats.last180d.energySavingsSelf/c),m[1].data.push(o.stats.last180d.energyIncome/c),m[2].data.push(o.stats.last180d.correntlyIncome/c)),void 0!==o.stats.last365d&&(g.push("365 Tage"),c=(o.stats.last365d.energySavingsSelf+o.stats.last365d.energyIncome+o.stats.last365d.correntlyIncome)/100,m[0].data.push(o.stats.last365d.energySavingsSelf/c),m[1].data.push(o.stats.last365d.energyIncome/c),m[2].data.push(o.stats.last365d.correntlyIncome/c)),r.push(o.stats[s].energySavingsSelf),d.push("Eigenstrom"),r.push(o.stats[s].energyIncome),d.push("Einspeisung"),r.push(o.stats[s].correntlyIncome),d.push("Corrently Erzeugung"),0!==$("#einnahmenChart").length){new Chart(l,{type:"doughnut",data:{datasets:[{label:"Einnahmen Verteilung",data:r,backgroundColor:["#006c32","#318b4e","#86df9b"]}],labels:d},options:{responsive:!0,legend:{position:"right"},plugins:{datalabels:{display:!0,color:"#000000",formatter:function(t,a){return(t/o.stats[s].energyRevenue*100).toFixed(1).replace(".",",")+"%"}}},title:{display:!1,text:""},animation:{animateScale:t,animateRotate:t},tooltips:{enabled:!0,mode:"single",callbacks:{label:function(t,s){return d[t.index]+": "+s.datasets[0].data[t.index]+"€"}}},elements:{center:{text:o.stats[s].energyRevenue.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2}),color:"#006C32",fontStyle:"Arial",sidePadding:20,minFontSize:20,lineHeight:25}}}});l.click((function(){$("#modalEinnahmen").modal("show")}));let a=$("#einnahmenChartB"),e=(new Chart(a,{type:"bar",data:{datasets:m,labels:g},options:{responsive:!0,tooltips:{enabled:!0,mode:"single",callbacks:{label:function(t,s){return s.datasets[t.datasetIndex].label+": "+Math.round(t.value)+"%"}}},plugins:{datalabels:{display:!0,color:"#000000",formatter:function(t,s){return Math.round(t)+"%"}}},legend:{position:"right"},title:{display:!1,text:""},animation:{animateScale:t,animateRotate:t},scales:{xAxes:[{stacked:!0}],yAxes:[{stacked:!0,ticks:{min:0,max:100}}]}}}),$("#ausgabenChart")),i=[],n=[];i.push(o.stats[s].energyCost),n.push("Strombezug"),i.push(o.stats[s].amortization),n.push("Abschreibung"),i.push(o.stats[s].baseCosts),n.push("Grundgebühr");let c=[],h=[];h.push("24 Stunden");let u=(o.stats.last24h.energyCost+o.stats.last24h.amortization+o.stats.last24h.baseCosts)/100;c.push({label:"Strombezug",backgroundColor:"#FFA700",data:[o.stats.last24h.energyCost/u]}),c.push({label:"Abschreibung",backgroundColor:"#FF8922",data:[o.stats.last24h.amortization/u]}),c.push({label:"Grundgebühr",backgroundColor:"#FFF6E4",data:[o.stats.last24h.baseCosts/u]}),void 0!==o.stats.last7d&&(u=(o.stats.last7d.energyCost+o.stats.last7d.amortization+o.stats.last7d.baseCosts)/100,h.push("7 Tage"),c[0].data.push(o.stats.last7d.energyCost/u),c[1].data.push(o.stats.last7d.amortization/u),c[2].data.push(o.stats.last7d.baseCosts/u)),void 0!==o.stats.last30d&&(h.push("30 Tage"),u=(o.stats.last30d.energyCost+o.stats.last30d.amortization+o.stats.last30d.baseCosts)/100,c[0].data.push(o.stats.last30d.energyCost/u),c[1].data.push(o.stats.last30d.amortization/u),c[2].data.push(o.stats.last30d.baseCosts/u)),void 0!==o.stats.last90d&&(h.push("90 Tage"),u=(o.stats.last90d.energyCost+o.stats.last90d.amortization+o.stats.last90d.baseCosts)/100,c[0].data.push(o.stats.last90d.energyCost/u),c[1].data.push(o.stats.last90d.amortization/u),c[2].data.push(o.stats.last90d.baseCosts/u)),void 0!==o.stats.last180d&&(h.push("180 Tage"),u=(o.stats.last180d.energyCost+o.stats.last180d.amortization+o.stats.last180d.baseCosts)/100,c[0].data.push(o.stats.last180d.energyCost/u),c[1].data.push(o.stats.last180d.amortization/u),c[2].data.push(o.stats.last180d.baseCosts/u)),void 0!==o.stats.last365d&&(h.push("365 Tage"),u=(o.stats.last365d.energyCost+o.stats.last365d.amortization+o.stats.last365d.baseCosts)/100,c[0].data.push(o.stats.last365d.energyCost/u),c[1].data.push(o.stats.last365d.amortization/u),c[2].data.push(o.stats.last365d.baseCosts/u)),e.click((function(){$("#modalAusgaben").modal("show")}));new Chart(e,{type:"doughnut",data:{datasets:[{label:"Ausgaben Verteilung",data:i,backgroundColor:["#FFA700","#FF8922","#FFF6E4"]}],labels:n},options:{responsive:!0,legend:{position:"left"},plugins:{datalabels:{display:!0,color:"#000000",formatter:function(t,a){return(t/o.stats[s].energySpendings*100).toFixed(1).replace(".",",")+"%"}}},title:{display:!1,text:""},animation:{animateScale:t,animateRotate:t},tooltips:{enabled:!0,mode:"single",callbacks:{label:function(t,s){return n[t.index]+": "+s.datasets[0].data[t.index]+"€"}}},elements:{center:{text:o.stats[s].energySpendings.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2}),color:"#FFA700",fontStyle:"Arial",sidePadding:20,minFontSize:20}}}});let y=$("#ausgabenChartB");new Chart(y,{type:"bar",data:{datasets:c,labels:h},options:{responsive:!0,tooltips:{enabled:!0,mode:"single",callbacks:{label:function(t,s){return s.datasets[t.datasetIndex].label+": "+Math.round(t.value)+"%"}}},plugins:{datalabels:{display:!0,color:"#000000",formatter:function(t,s){return Math.round(t)+"%"}}},legend:{position:"right"},title:{display:!1,text:""},animation:{animateScale:t,animateRotate:t},scales:{xAxes:[{stacked:!0}],yAxes:[{stacked:!0,ticks:{min:0,max:100}}]}}})}t&&setTimeout((function(){$("#info").addClass("show")}),2e3),t=!1;let h=o.stats[s].consumption_wh*o.meterinfo.energyPriceWh+o.stats[s].baseCosts,u=Math.round(1e4*(1- -1*o.stats[s].incomeSaldo/h))/100;i<(new Date).getTime()-6e4&&(window.swiper.slides&&window.swiper.slides.length>0&&window.swiper.removeAllSlides(),window.swiper.slides&&(window.swiper.appendSlide('<div class="blog-slider__item swiper-slide"><div class="blog-slider__content"><div class="blog-slider__title"><i class="fa fa-info-circle" style="  margin-right: 10px;"></i>Ausgaben</div><div class="blog-slider__text" id="info0"><strong>'+Math.round(o.stats[s].energyCost/o.stats[s].energySpendings*100)+"%</strong> der Kosten von "+o.stats[s].energySpendings.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})+"€ für die Stromversorgung sind variabel, d.h. können durch den Verbrauch unmittelbar beeinflusst werden.</div></div></div>"),window.swiper.appendSlide('<div class="blog-slider__item swiper-slide"><div class="blog-slider__content"><div class="blog-slider__title"><i class="fa fa-wrench" style="  margin-right: 10px;"></i>Ergebnis</div><div class="blog-slider__text" id="info1">Steigere den Netzbezug zu Zeiten mit hohen Werten des GrünstromIndex, um die Erträge aus Corrently Erzeugung von derzeit <strong>'+o.stats[s].correntlyIncome.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})+"€</strong> zu eröhen.</div></div></div>"),window.swiper.appendSlide('<div class="blog-slider__item swiper-slide"><div class="blog-slider__content"><div class="blog-slider__title"><i class="fa fa-tachometer" style="  margin-right: 10px;"></i>Ergebnis</div><div class="blog-slider__text" id="info1"><strong>'+u.toLocaleString("de-DE",{minimumFractionDigits:0,maximumFractionDigits:2})+"%</strong> im Vergleich zu einem Anschluss ohne eigene Erzeugung, Speicher oder Corrently GrünstromBonus.</div></div></div>")),i=(new Date).getTime())}$("#modEigenverbrauch").change((function(){window.modActive||($(".planerRows").hide(),$("#eigenRow").show()),window.modActive=!0,l()})),$("#modEigenverbrauch").on("input change",(function(){$("#eigenverbrauchsQuote").html($("#modEigenverbrauch").val())})),$("#modAmotisation").change((function(){window.modActive||($(".planerRows").hide(),$("#amotRow").show()),window.modActive=!0,l()})),$("#modAmotisation").on("input change",(function(){$("#amotisation").html($("#modAmotisation").val())})),$("#modErz").change((function(){window.modActive||($(".planerRows").hide(),$("#erzRow").show()),window.modActive=!0,l()})),$("#modErz").on("input change",(function(){$("#erz").html($("#modErz").val().toLocaleString("de-DE",{minimumFractionDigits:3,maximumFractionDigits:3}))})),$("#modBedarf").change((function(){window.modActive||($(".planerRows").hide(),$("#bedRow").show()),window.modActive=!0,l()})),$("#modBedarf").on("input change",(function(){$("#bedarf").html($("#modBedarf").val().toLocaleString("de-DE",{minimumFractionDigits:3,maximumFractionDigits:3}))}))}catch(t){console.log(t),window.localStorage.removeItem("msg"),console.log("Removed stalled cached msg"),setTimeout((function(){r()}),15e3)}},r=function(){o=void 0!==window.localStorage.getItem("cid")&&null!==window.localStorage.getItem("cid")?"./p2p?method=msg&peer="+window.localStorage.getItem("cid"):"./msg",(n>20||0==n)&&$.getJSON(o,(function(t){window.localStorage.setItem("msg",JSON.stringify(t)),n=0,l()})).fail((function(){console.log("Switched to WAN Source"),$.getJSON("https://casa-corrently-demo.herokuapp.com/"+o,(function(t){window.localStorage.setItem("msg",JSON.stringify(t)),n=0,l()}))})),n++};l(),setInterval(r,1e4),r(),$("#cbStrompreis").click((function(){let t="./history";void 0!==window.localStorage.getItem("cid")&&null!==window.localStorage.getItem("cid")&&(t="./ipfs?cid="+window.localStorage.getItem("history")),$("#modalStrompreis").modal(),$.getJSON(t,(function(s){let a={};a.localHistory=s;let e=[],i=[],o=[],n=[],l=[],r=[];if(void 0!==a.localHistory&&void 0!==a.localHistory.sort){a.localHistory.sort((function(t,s){return t.time>s.time?1:s.time>t.time?-1:0}));for(let s=0;s<a.localHistory.length;s++)"./history"!=t&&a.localHistory[s].uuid!=window.localStorage.getItem("cid")||(void 0!==a.localHistory[s].stats.last24h&&e.push({y:1*a.localHistory[s].stats.last24h,x:1*a.localHistory[s].time}),void 0!==a.localHistory[s].stats.last7d&&i.push({y:1*a.localHistory[s].stats.last7d,x:1*a.localHistory[s].time}),void 0!==a.localHistory[s].stats.last30d&&o.push({y:1*a.localHistory[s].stats.last30d,x:1*a.localHistory[s].time}),void 0!==a.localHistory[s].stats.last90d&&n.push({y:1*a.localHistory[s].stats.last90d,x:1*a.localHistory[s].time}),void 0!==a.localHistory[s].stats.last180d&&l.push({y:1*a.localHistory[s].stats.last180d,x:1*a.localHistory[s].time}),void 0!==a.localHistory[s].stats.last365d&&r.push({y:1*a.localHistory[s].stats.last365d,x:1*a.localHistory[s].time}));let s=$("#trendChart");new Chart(s,{type:"line",data:{datasets:[{type:"line",label:"24 Stunden",data:e,borderColor:"#000000",backgroundColor:"#000000",fill:!1,yAxisID:"y-axis-1"},{type:"line",label:"7 Tage",data:i,borderColor:"#8B4513",backgroundColor:"#8B4513",fill:!1,yAxisID:"y-axis-1"},{type:"line",label:"30 Tage",data:o,borderColor:"#A0522D",backgroundColor:"#A0522D",fill:!1,yAxisID:"y-axis-1"},{type:"line",label:"90 Tage",data:n,borderColor:"#D2691E",backgroundColor:"#D2691E",fill:!1,yAxisID:"y-axis-1"},{type:"line",label:"180 Tage",data:l,borderColor:"#E8A392",backgroundColor:"#E8A392",fill:!1,yAxisID:"y-axis-1"},{type:"line",label:"365 Tage",data:r,borderColor:"#FF0000",backgroundColor:"#FF0000",fill:!1,yAxisID:"y-axis-1"}]},options:{title:{display:!1,text:"Title"},elements:{point:{radius:0}},plugins:{datalabels:{display:!1}},legend:{position:"bottom"},scales:{xAxes:[{type:"time",distribution:"linear"}],yAxes:[{ticks:{beginAtZero:!1},display:!0,position:"left",id:"y-axis-1",scaleLabel:{display:!0,labelString:"Euro"}}]}}})}}))})),$("#collapplaner").on("hide.bs.collapse",(function(){location.reload()}))}));