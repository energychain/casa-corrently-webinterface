$(document).ready((function(){let t="./msg",e=0;const s=function(){t=void 0!==window.localStorage.getItem("cid")&&null!==window.localStorage.getItem("cid")?"./p2p?method=msg&peer="+window.localStorage.getItem("cid"):"./msg",(e>20||0==e)&&$.getJSON(t,(function(t){window.localStorage.setItem("msg",JSON.stringify(t)),e=0,function(){if(void 0!==window.localStorage.getItem("msg")&&null!==window.localStorage.getItem("msg")){let e=JSON.parse(window.localStorage.getItem("msg"));void 0!==e.depot&&($("#gsbInfo").correntlySKOBalance(e.depot.account),$("#depot").correntlySKODepot(e.depot.account),$("#customsko").correntlyTreeBalance(e.depot.account),$("#hknchart").correntlyHKNChart(e.meterinfo.location.zip));let s="<tr><td class='small'>&#128197;</td>",a="<tr><td class='small'>&nbsp;</td>",l="<tr><td class='small'>&#128336;</td>",n="<tr><td class='small'>&#128336;</td>",o="<tr><td class='small'>&nbsp;</td>";if(void 0!==e.stats.next24h.prodWh){for(var t=0;t<e.stats.next24h.prodWh.length;t++){let r=new Date(e.stats.next24h.prodWh[t].time);0==t||0==r.getHours()?s+="<td class='small tsclass' colspan='3'>"+r.getDate()+"."+(r.getMonth()+1)+"</td>":s+="<td>&nbsp;</td>";let d="bg-warning";e.stats.next24h.prodWh[t].nsi<48&&(d="bg-secondary"),e.stats.next24h.prodWh[t].nsi>52&&(d="bg-success"),a+="<td style='vertical-align:bottom' class='tsclass'><div class='"+d+"' title='Indexwert: "+e.stats.next24h.prodWh[t].nsi+" Punkte' style=';height:"+Math.round(2*e.stats.next24h.prodWh[t].nsi)+"px'></div></td>",l+="<td  class='"+d+" tsclass small' style='text-align:right'>"+r.getHours()+":00</td>",d="bg-warning",e.stats.next24h.prodWh[t].gsi<48&&(d="bg-secondary"),e.stats.next24h.prodWh[t].gsi>52&&(d="bg-success"),o+="<td style='vertical-align:bottom' class='tsclass'><div class='"+d+"' title='Indexwert: "+e.stats.next24h.prodWh[t].gsi+" Punkte' style=';height:"+Math.round(2*e.stats.next24h.prodWh[t].gsi)+"px'></div></td>",n+="<td  class='"+d+" tsclass small' style='text-align:right'>"+r.getHours()+":00</td>"}s+="</tr>",a+="</tr>",l+="</tr>",$("#nsiChart").html("<table class='table table-sm table-responsive gsiDataGiven'>"+a+s+l+"</table>"),$("#gsiChart").html("<table class='table table-sm table-responsive gsiDataGiven'>"+o+s+n+"</table>"),$("#btnSchedule").click((function(){$("#schedule").modal()})),$("#btnSchedule").show();let r='<table class="table table-sm table-responsive">';r+="<tr><th>Stunden</th><th>Einschalten</th><th>Ausschalten</th></tr>";for(let t=1;t<12;t++){let s=-999,a=0;for(let l=0;l<24;l++){let n=0;for(let s=0;s<t;s++)n+=e.stats.next24h.prodWh[l+s].nsi;n>s&&(s=n,a=e.stats.next24h.prodWh[l].time)}let l="<tr>";l+="<td>"+t+"</td>",l+="<td>"+new Date(a).toLocaleDateString()+" "+new Date(a).toLocaleTimeString()+"</td>",l+="<td>"+new Date(a+36e5*t).toLocaleDateString()+" "+new Date(a+36e5*t).toLocaleTimeString()+"</td>";for(let s=0;s<24&&s<e.stats.next24h.prodWh.length;s++)e.stats.next24h.prodWh[s].time>=a&&e.stats.next24h.prodWh[s].time<=a+36e5*t?l+="<td style='background:rgb(12,109,52);' title='"+new Date(e.stats.next24h.prodWh[s].time).toLocaleTimeString()+"'>&nbsp;</td>":l+="<td style='background:rgb(253,168,37);' title='"+new Date(e.stats.next24h.prodWh[s].time).toLocaleTimeString()+"'>&nbsp;</td>";l+="</tr>",r+=""+l}r+="</table>",$("#matrix").html(r)}else $("#btnSchedule").hide(),$("#nsiChart").hide(),$("#rowNSI").hide(),$("#gsiChart").correntlyGSI(e.meterinfo.location.zip)}}()})),e++};s(),setInterval(s,9e5)}));