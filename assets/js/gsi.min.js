$(document).ready((function(){let t="./msg",e=0;const s=function(){t=void 0!==window.localStorage.getItem("cid")&&null!==window.localStorage.getItem("cid")?"./p2p?method=msg&peer="+window.localStorage.getItem("cid"):"./msg",(e>20||0==e)&&$.getJSON(t,(function(t){window.localStorage.setItem("msg",JSON.stringify(t)),e=0,function(){if(void 0!==window.localStorage.getItem("msg")&&null!==window.localStorage.getItem("msg")){let e=JSON.parse(window.localStorage.getItem("msg"));void 0!==e.depot&&($("#gsbInfo").correntlySKOBalance(e.depot.account),$("#depot").correntlySKODepot(e.depot.account),$("#customsko").correntlyTreeBalance(e.depot.account),$("#hknchart").correntlyHKNChart(e.meterinfo.location.zip));let s="<tr><td class='small'>&#128197;</td>",l="<tr><td class='small'>&nbsp;</td>",a="<tr><td class='small'>&#128336;</td>",n="<tr><td class='small'>&#128336;</td>",o="<tr><td class='small'>&nbsp;</td>";for(var t=0;t<e.stats.next24h.prodWh.length;t++){let d=new Date(e.stats.next24h.prodWh[t].time);0==t||0==d.getHours()?s+="<td class='small tsclass' colspan='3'>"+d.getDate()+"."+(d.getMonth()+1)+"</td>":s+="<td>&nbsp;</td>";let r="bg-warning";e.stats.next24h.prodWh[t].nsi<48&&(r="bg-secondary"),e.stats.next24h.prodWh[t].nsi>52&&(r="bg-success"),l+="<td style='vertical-align:bottom' class='tsclass'><div class='"+r+"' title='Indexwert: "+e.stats.next24h.prodWh[t].nsi+" Punkte' style=';height:"+Math.round(2*e.stats.next24h.prodWh[t].nsi)+"px'></div></td>",a+="<td  class='"+r+" tsclass small' style='text-align:right'>"+d.getHours()+":00</td>",r="bg-warning",e.stats.next24h.prodWh[t].gsi<48&&(r="bg-secondary"),e.stats.next24h.prodWh[t].gsi>52&&(r="bg-success"),o+="<td style='vertical-align:bottom' class='tsclass'><div class='"+r+"' title='Indexwert: "+e.stats.next24h.prodWh[t].gsi+" Punkte' style=';height:"+Math.round(2*e.stats.next24h.prodWh[t].gsi)+"px'></div></td>",n+="<td  class='"+r+" tsclass small' style='text-align:right'>"+d.getHours()+":00</td>"}s+="</tr>",l+="</tr>",a+="</tr>",$("#nsiChart").html("<table class='table table-sm table-responsive gsiDataGiven'>"+l+s+a+"</table>"),$("#gsiChart").html("<table class='table table-sm table-responsive gsiDataGiven'>"+o+s+n+"</table>");let d={};for(let t=0;t<e.stats.next24h.prodWh.length&&t<24;t++){d["h_"+t]={time:e.stats.next24h.prodWh[t].time};let s=0,l=0;for(let a=t;a>0;a--)s+=e.stats.next24h.prodWh[t].nsi,l++,d["h_"+t]["avg_"+a]=Math.round(s/l);for(let s=t+1;s<e.stats.next24h.prodWh.length;s++)d["h_"+t]["avg_"+s]=!1}$("#btnSchedule").click((function(){$("#schedule").modal()}));let r='<table class="table table-condensed">';for(let t=1;t<12;t++){let s="<tr>";s+="<td>"+t+"</td>";for(let l=0;l<24;l++)e.stats.next24h.prodWh[t].time>d["h_"+t].time&&e.stats.next24h.prodWh[t].time-36e5*t>=d["h_"+t].time?s+="<td>1</td>":s+="<td>0</td>";s+="</tr>",r+=s}r+="</table>",$("#matrix").html(r)}}()})),e++};s(),setInterval(s,9e5)}));